# 0821

### 任务 文件上传模块(进度85%)

继续卡在这个进度了

今天重新理了下代码逻辑，

对于并发数是，假设并发数是3，有5个上传的文件，那是

**方案一** 3个文件同时上传，

**方案二**  还是一个上传完后再继续下一个文件上传？

看了其他下载文件，都是几个文件同时上传，（可能看起来效率比较快）

但这样的话比一个一个上传的逻辑复杂

**方案一** 另外一个问题：如果是同时多个文件上传，那是一个文件就保持队列某一个位置，不插队，即使此时某个文件已经成功返回，队列有空余的，这样的话就可以分出模块，外面就主要负责队列控制，里面就负责文件的分片上传，保持一片一片发

但是这样考虑性能问题，浪费空余的队列空间可以发送多个分片文件了，还不如**方案二**

所以如果自己能够实现的话

最终方案如下：

（1）多文件同时上传，如果是大文件，就保持一个文件一个请求分片接口，小文件，自然一个请求接口，然后某一文件上传完后，如果有其他没有上传的，就替补这个原来文件请求的队列，如果没有其他文件上传的，而有文件还在上传的话，那么正在上传的文件就可以多个请求接口发送其他的分片文件

点击暂停后，并发数允许内，接下来的文件继续上传，没有文件的话，就正在上传的文件可以多个请求接口发送接下来的分片文件

点击继续后，超过并发数的居于后面的文件停止上传，保持队列的优先级，即排在前面的优先发送

现在是支持同时上传文件了，如果队列空余，支持补上新的文件或者文件分片，保持队列充分利用

但就是暂停继续部分，暂停继续了1次可以，再暂停就有错误了，所以就是自己没有找到对应的上传文件，明天再看下代码

### 明日计划

继续实现多文件上传的队列控制和调整代码的规范

